<!DOCTYPE html>
<html>
<head>
    <script src="https://res.cdn.office.net/teams-js/2.2.0/js/MicrosoftTeams.min.js" 
      integrity="sha384yBjE++eHeBPzIg+IKl9OHFqMbSdrzY2S/LW3qeitc5vqXewEYRWegByWzBN/chRh" 
      crossorigin="anonymous">
    </script>
</head>
<body>
    <button onclick="selectGray()">Select Gray</button>
    <button onclick="selectRed()">Select Red</button>
    <button onclick="goBack()">Back</button>

    <script>
        // Initialize the Microsoft Teams SDK
        microsoftTeams.app.initialize().then(() => {
            console.log("Microsoft Teams SDK initialized");
        });

        // Function to save the gray configuration
        let saveGray = () => {
            microsoftTeams.pages.config.registerOnSaveHandler((saveEvent) => {
                const configPromise = microsoftTeams.pages.config.setConfig({
                    websiteUrl: "https://google.com",
                    contentUrl: "https://www.google.com/imghp",
                    entityId: "grayIconTab",
                    suggestedDisplayName: "MyNewTab"
                });
                configPromise
                    .then((result) => { saveEvent.notifySuccess(); })
                    .catch((error) => { saveEvent.notifyFailure("failure message"); });
            });
        };

        // Function to save the red configuration
        let saveRed = () => {
            microsoftTeams.pages.config.registerOnSaveHandler((saveEvent) => {
                const configPromise = microsoftTeams.pages.config.setConfig({
                    websiteUrl: "https://google.com",
                    contentUrl: "https://www.google.com/imghp",
                    entityId: "redIconTab",
                    suggestedDisplayName: "MyNewTab"
                });
                configPromise
                    .then((result) => { saveEvent.notifySuccess(); })
                    .catch((error) => { saveEvent.notifyFailure("failure message"); });
            });
        };

        // Function to handle the selection of the gray option
        const selectGray = () => {
            microsoftTeams.pages.config.setValidityState(true);
            saveGray();
        };

        // Function to handle the selection of the red option
        const selectRed = () => {
            microsoftTeams.pages.config.setValidityState(true);
            saveRed();
        };

        // Function to handle the back navigation
        const goBack = () => {
            microsoftTeams.pages.navigateBack().then((success) => {
                if (!success) {
                    console.log("No previous tab to navigate back to.");
                }
            }).catch((error) => {
                console.error("Error navigating back:", error);
            });
        };
    </script>
</body>
</html>